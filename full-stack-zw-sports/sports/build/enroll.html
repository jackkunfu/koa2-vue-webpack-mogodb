<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><title>课程报名</title><link rel="stylesheet" href="css/reset-dd71e4cbba.css"><script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script src="https://cdn.bootcss.com/vue/2.2.6/vue.min.js"></script><script src="js/common-9de3ecab4b.js"></script><script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script></head><body><style>.row{margin-bottom:.5rem}.row::after{clear:both}.form .row .fl,.form .row .fr{float:none;font-size:1.3rem;line-height:3rem}.form .row .fl{padding-left:1rem;line-height:1.5;color:#7dc8e1}.form .row .fr{width:100%;padding:0 1rem}.form .row .fr input,.form .row .fr select,.form .row .fr textarea{font-size:1rem;padding-left:.5rem;width:100%;height:3rem;line-height:3rem;border:1px solid #eee}select option{font-size:1.5rem;line-height:1}.form .row .fr textarea{height:10rem}.form .row .fr input[type=radio]{margin-left:1rem;width:1rem}</style><div id="ctn"><div class="top">报名{{name}}</div><div class="form ctn" style="padding-bottom:3rem"><div class="row"><div class="fl">课程类型</div><div class="fr"><div class="select" @click="selectOpen1=!selectOpen1;"><span>{{item.classTypeName}}</span><ul v-show="selectOpen1"><li v-for="cl in selectList" @click="item.pay = cl.fee; item.classType= cl.id;item.classTypeName=cl.name">{{cl.name}}</li></ul></div></div></div><div class="row"><div class="fl">学员姓名</div><div class="fr"><input type="text" v-model="item.name"></div></div><div class="row"><div class="fl">性别</div><div class="fr"><div class="select" @click="selectOpen=!selectOpen;"><span>{{item.sex | sex}}</span><ul v-show="selectOpen"><li @click="item.sex = '0'">男</li><li @click="item.sex = '1'">女</li></ul></div></div></div><div class="row"><div class="fl">生日</div><div class="fr"><input type="text" v-model="item.birthVal" placeholder="-符号隔开： 2017-01-01"></div></div><div class="row"><div class="fl">地址</div><div class="fr"><input type="text" v-model="item.address"></div></div><div class="row"><div class="fl">父母姓名</div><div class="fr"><input type="text" v-model="item.familyName"></div></div><div class="row"><div class="fl">父母手机</div><div class="fr"><input type="text" v-model="item.mobile"></div></div><div class="row"><div class="fl">备注</div><div class="fr"><textarea type="text" v-model="item.desc"></textarea></div></div><div class="fixed-btm"><div class="fl">费用合计 <span style="color:red;margin:0 10px"><span>{{item.pay}}</span> </span>元</div><div class="fr" @click="pay">报名支付</div></div></div></div><script>Vue.config.devtools=!0,new Vue({el:"#ctn",filters:{sex:function(t){return t-0==1?"女":"男"}},data:{selectList:[{id:1,fee:1,name:"xxx"},{id:1,fee:2,name:"xxx2"},{id:1,fee:3,name:"xxx3"}],name:null,isTry:!1,item:{classType:"",name:"",sex:"0",birthVal:"",address:"",familyName:"",mobile:"",desc:"",pay:"",pay1:100,pay2:200,pay3:300,trainId:null},selectOpen1:!1,selectOpen2:!1,selectOpen3:!1,selectOpen:!1},mounted:function(){this.item.trainId=location.href.split("id=")[1].split("&")[0],this.name=location.href.split("name=")[1]?decodeURI(location.href.split("name=")[1].split("&")[0]):"";var t=this;this.$nextTick(function(){}),this._ajaxData("get","/zhengwu/class/list",{trainId:this.item.trainId,pageNo:1},function(e){t.selectList=e.list})},methods:{pay:function(){var t=this;this.item.classType?this.item.name&&""!=this.item.name.trim()?this.item.sex&&""!=this.item.sex.trim()?this.item.birthVal&&""!=this.item.birthVal.trim()?this.item.address&&""!=this.item.address.trim()?this.item.familyName&&""!=this.item.familyName.trim()?this.item.mobile&&""!=this.item.mobile.trim()?/^1[3|4|5|8][0-9]\d{4,8}$/.test(this.item.mobile)?(this.item.birth=this.item.birthVal,this.item.userinfoId=localStorage.zwUserId,this._ajaxData("post","/zhengwu/user",this.item,function(e){t._ajaxData("post","/zhengwu/pay",{fee:100*t.item.pay,userId:e.id,title:t.item.classTypeName},function(e){t.item.pay>0?t.startWxPay(e):(alert("报名成功"),window.location.href="bill.html")})})):alert("手机号格式不对~"):alert("手机没选~"):alert("家长姓名没填~"):alert("地址没填~"):alert("生日没填~"):alert("性别没选~"):alert("姓名没填~"):alert("课程类型没选~")},startWxPay:function(t){wx.config({debug:!1,appId:t.appId,timestamp:t.timeStamp,nonceStr:t.nonceStr,signature:t.paySign,jsApiList:["chooseWXPay"]}),wx.chooseWXPay({timestamp:t.timeStamp,nonceStr:t.nonceStr,package:t.package,signType:"MD5",paySign:t.paySign,success:function(t){"chooseWXPay:ok"==t.errMsg?alert("支付成功"):alert(t.errMsg),window.location.href="bill.html"},cancel:function(t){window.location.href="bill.html"}})}}})</script></body></html>