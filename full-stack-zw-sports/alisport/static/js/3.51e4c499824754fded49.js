webpackJsonp([3],{25:function(t,e,a){function i(t){a(93)}var s=a(2)(a(95),a(96),i,"data-v-e5c7fff2",null);t.exports=s.exports},43:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAAgtJREFUWIXt1ztrFGEYhuErBxVFQUGbrewELRfUQkEQPIBiPGEjBpIgKmJhYauInY1FEJRoPKBBEBQlmEBAEH+CB/wFBmwEjahEYvElknyTmewuk5kgc8Oyy7MM3OzOPO/7UVFRUQFt9Xq9leu2YhAbcR1X8lNKp72Fa3ZgDJuxCpexKU+pNJqV3YlXWBPly/LRyaYZ2V0Yweoof4B3eQll0ajsbgwLf/tsHqEnV6MMGpHdgxeSovfRjT95S6WxkOw+PJcUHUSvAkXJlt0viK6M8gEliJIue1AQXRHlt3AaU4splcZ8sl14iuVRfhNnlSRKUvYonkiK9uO8EkWZK3scQ5KiN3BByaLQOf1+QujMjuj7O7iKtUVKRUzhK2GRSRNdSoyjp61er3/B+rJtGuBzK1tXabQLT3nhBd8k4+jtFKqqHQ8l79sBXCpYLObfAzbTBkOYxONZGfThOy5aAtXVUavVZj5/mH51mfsLb8c6jBarlmS2LHzEexw2V3gbNginhNKYrw2e4Rh+R/k5YT9oW2ypNNKq6yWO4FeUn8FtJQln9eywcP/+jPI+oSUKn3gLDYURQfhHlPcIe0Ohwo1MsFEckhTuxj0FCjc6bsdwQFL4JO7mapRBM7vBa+FcNhHlp7AlN6MMml1k3ggn3m9RPpmPTjatbF1vsVeYdhO4hk95SlVUVFT8R/wFRURXGecH2+wAAAAASUVORK5CYII="},47:function(t,e,a){t.exports={default:a(48),__esModule:!0}},48:function(t,e,a){var i=a(49),s=i.JSON||(i.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}},49:function(t,e){var a=t.exports={version:"2.5.0"};"number"==typeof __e&&(__e=a)},93:function(t,e,a){var i=a(94);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(18)("4edd8733",i,!0)},94:function(t,e,a){e=t.exports=a(17)(!1),e.push([t.i,'.sort input[data-v-e5c7fff2]{text-align:right;padding-right:.5rem;height:2rem;font-size:1rem;border:none;color:#666;float:right;margin-top:.15rem;margin-right:.5rem}.shade-panel[data-v-e5c7fff2]{z-index:20!important}.charge[data-v-e5c7fff2]{float:left;text-align:left}.charge span[data-v-e5c7fff2]{font-size:.8rem;color:#666}.charge input[data-v-e5c7fff2]{height:2rem;font-size:.8rem;width:100%;border:1px solid #c1c1c1!important;padding-right:0!important;padding-left:.5rem;text-align:left!important}.upimg[data-v-e5c7fff2]{width:100%;height:100%;left:0;top:0;background:#fff}.fee input[data-v-e5c7fff2]{text-align:left;padding-left:1rem}.fee img[data-v-e5c7fff2]{width:1.5rem}.key[data-v-e5c7fff2]{font-size:.9rem!important}.address[data-v-e5c7fff2]{overflow:hidden;border-bottom:1px solid #c1c1c1!important}.address[data-v-e5c7fff2]:after{content:">";display:block;width:.5rem;height:1rem;line-height:1rem;position:absolute;color:#666;top:.9rem;right:.9rem;-webkit-transform:scale(.9,1.7);transform:scale(.9,1.7)}.address input[data-v-e5c7fff2]{width:20.5rem;font-size:.8rem;padding-right:1rem}.map-ctn #map[data-v-e5c7fff2],.map-ctn .close[data-v-e5c7fff2],.map-ctn .search[data-v-e5c7fff2]{position:fixed}.map-ctn #map[data-v-e5c7fff2]{width:100%;height:100%;top:0;left:0}.map-ctn .search[data-v-e5c7fff2]{width:20rem;height:2.5rem;top:3rem;left:50%;margin-left:-10rem}.map-ctn .search input[data-v-e5c7fff2]{width:100%;height:100%;background:#fff;font-size:1rem}.map-ctn .close[data-v-e5c7fff2]{width:5rem;height:5rem;font-size:4rem;text-align:center;background:#fff;border:1px solid #c1c1c1;top:10rem;left:50%;margin-left:20rem}',""])},95:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=a(47),n=i(s),r=a(0),o=i(r),l=function(t){return 1==(t+"").length?"0"+t:t},c=function(t){var e=new Date(t);return l(e.getFullYear())+"-"+l(e.getMonth()+1)+"-"+l(e.getDate())+" "+l(e.getHours())+":"+l(e.getMinutes())};e.default={name:"addActi",filters:{time:function(t){return t}},data:function(){return{team:{image:"",joinway:0,events:[],keys:[],tags:[],address:"",startDate:"",endDate:"",matchStartDate:"",matchEndDate:""},tags:[],showDate:!1,newTag:"",time:null,timeInput:null,newChargeKey:"",newCharge:"",key:[{key:"name",str:"真实姓名"},{key:"sex",str:"性别"},{key:"mobile",str:"手机号"},{key:"email",str:"邮箱"},{key:"country",str:"国籍"},{key:"city",str:"城市"},{key:"address",str:"详细地址"},{key:"blood",str:"血型"},{key:"birth",str:"出生日期"},{key:"cardType",str:"证件类型"},{key:"cardno",str:"证件号"},{key:"clothSize",str:"服装尺码"},{key:"contact",str:"紧急联系人"},{key:"contactNumber",str:"紧急联系人电话"},{key:"raceCert",str:"完赛证明"},{key:"healthCert",str:"健康证明"}],feeNames:[],id:this.$route.query.id,groupId:this.$route.query.groupId,isMapShow:!1}},mounted:function(){var t=this;this.$nextTick(function(){t.cmFun.ajax("GET","/active/detail/"+t.id+"/"+localStorage.aliSportUserId,{},function(e){t.allData=e.data,t.team=e.data.active,t.team.matchStartDate=c(t.team.matchStartDate),t.team.matchEndDate=c(t.team.matchEndDate),t.team.startDate=c(t.team.startDate),t.team.endDate=c(t.team.endDate);var a=JSON.parse(t.team.userKeys).map(function(t){return t.key});t.team.keys=t.key.map(function(e){return a.indexOf(e.key)>-1?t.$set(e,"isChoose",!0):t.$set(e,"isChoose",!1),e})});var e=t,a=function(t,e){return{trigger:"#"+t,type:"datetime",minDate:"2010-1-1",maxDate:"2099-1-1",onSubmit:function(){e&&e(this.value)},onClose:function(){}}};(new datePicker).init(a("matchStartDate")),(new datePicker).init(a("matchEndDate",function(t){new Date(t).getTime()<=new Date(e.team.matchStartDate).getTime()&&(alert("活动结束时间须大于开始时间"),setTimeout(function(){e.team.matchEndDate=""},0))})),(new datePicker).init(a("startDate",function(t){new Date(t).getTime()>=new Date(e.team.matchStartDate).getTime()&&(alert("报名开始时间须小于活动开始时间"),setTimeout(function(){e.team.startDate=""},0))})),(new datePicker).init(a("endDate",function(t){new Date(t).getTime()>=new Date(e.team.matchStartDate).getTime()&&(alert("报名结束时间须小于活动开始时间"),setTimeout(function(){e.team.endDate=""},0)),new Date(t).getTime()<=new Date(e.team.startDate).getTime()&&(alert("报名结束时间须大于开始时间"),setTimeout(function(){e.team.endDate=""},0))}))})},methods:{upImg:function(t){var e=this;this.cmFun.upFile(t,"",function(t){1!=t.code&&alert(t.msg),1==t.code&&(e.team.image=t.data)})},changeFee:function(){var t=this.newChargeKey.trim();return""==t||""==this.newCharge.trim()?void alert("规格名称或者费用不能为空"):isNaN(parseFloat(this.newCharge.trim()))?void alert("费用应为数字"):this.feeNames.indexOf(t)>=0?void alert("已存在该项目"):(this.feeNames.push(t),this.team.events||(this.team.events=[]),void this.team.events.push({name:this.newChargeKey,fee:this.newCharge,userId:localStorage.aliSportUserId}))},submit:function(){var t=this;if(this.testRule()){var e=o.default.extend(!0,{},this.team),a={};a.userId=localStorage.aliSportUserId,a.groupId=this.groupId,a.id=this.id;var i=e.keys.filter(function(t,e){return 1==t.isChoose});i.map(function(t){return delete t.isChoose,t}),a.keys=(0,n.default)(i),a.startDate=Date.parse(new Date(e.startDate)),a.endDate=Date.parse(new Date(e.endDate)),a.matchStartDate=Date.parse(new Date(e.matchStartDate)),a.matchEndDate=Date.parse(new Date(e.matchEndDate)),a.address=e.address,a.image=e.image,a.joinway=e.joinway;var s=e.tags.map(function(t){return{tag:t.tag}});console.log("newTags"),console.log((0,n.default)(s)),a.tags=(0,n.default)(s),a.name=e.name,a.maxPerson=e.maxPerson,a.detail=e.detail,a.declaration=e.declaration,console.log(a),this.cmFun.ajax("post","/active/save",a,function(e){if(1!=e.code)return void alert(e.msg);alert("修改成功~"),t.$router.push({path:"/activityDetail",query:{id:t.id,groupId:t.groupId}})})}},del:function(t){this.team.events.splice(t,1),this.feeNames.splice(t,1)},addTag:function(){var t=this.newTag.replace(/\s+/g,"");if(""!=t){if(t.length>5)return void alert("标签长度不能大于5");this.team.tags.map(function(t){return t.tag}).indexOf(t)<0?(this.team.tags.push({tag:t}),this.newTag=""):alert("已存在")}},delTag:function(t){this.team.tags.splice(t,1)},goBack:function(){window.history.go(-1)},timeChange:function(t){this.time=t,this.team[this.timeInput]=t,this.showDate=!1},changeChoose:function(t){1==this.team[t]?this.team[t]=0:this.team[t]=1},showMap:function(){function t(t){t.poi&&t.poi.location&&(s.setZoom(15),s.setCenter(t.poi.location),marker.setPosition(new AMap.LngLat(t.poi.location.lng,t.poi.location.lat)))}var e,a=this,i=!0;this.cmFun.getLocation(function(t){a.lng=t.coords.longitude,a.lat=t.coords.latitude,e=[t.coords.longitude,t.coords.latitude],i=!1}),this.isMapShow=!0;var s=new AMap.Map("map",{resizeEnable:!0,zoom:13,center:i?[120.180304,30.276887]:e}),n=this,r=(s.on("click",function(t){var e=t.lnglat.getLng(),a=t.lnglat.getLat();o.default.ajax({type:"GET",url:"https://restapi.amap.com/v3/geocode/regeo",dataType:"JSON",data:{output:"JSON",location:e+","+a,key:"5b384bd6b1c25c86a18cdef18c82c679",radius:10,extensions:"base"},success:function(t){console.log(t);var i=t.regeocode.addressComponent,s={longitude:e,latitude:a,province:i.province,city:"string"==typeof i.city?i.city:"",area:i.district,address:t.regeocode.formatted_address};(0,o.default)(".amap-sug-result").remove(),n.team.address=s.address,n.team.longitude=s.longitude,n.team.latitude=s.latitude,n.isMapShow=!1}})}),new AMap.Autocomplete({input:"searchkey"}));AMap.event.addListener(r,"select",t)},testRule:function(){return this.team.name=this.team.name.trim()||"",this.team.maxPerson=(this.team.maxPerson+"").trim()||"",this.team.declaration=this.team.declaration.trim()||"",""==this.team.image?(alert("没传图片"),!1):""==this.team.name?(alert("名称不能为空"),!1):""==this.team.address?(alert("没选择地址"),!1):""==this.team.startDate?(alert("请选择开始时间"),!1):""==this.team.endDate?(alert("请选择结束时间"),!1):""==this.team.matchStartDate?(alert("请选择报名开始时间"),!1):""==this.team.matchEndDate?(alert("请选择报名结束时间"),!1):this.team.maxPerson+""==""||isNaN(this.team.maxPerson-0)||(this.team.maxPerson-0)%1>0?(alert("人员上限有误"),!1):this.team.tags&&0!=this.team.tags.length?this.team.keys&&0!=this.team.keys.length?""!=this.team.declaration||(alert("免责声明不能为空"),!1):(alert("没选择报名字段"),!1):(alert("标签没添加"),!1)}}}},96:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"addActivity"},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMapShow,expression:"!isMapShow"}]},[i("div",{staticClass:"form"},[i("div",{staticClass:"row"},[i("label",[t._v("活动封面")]),i("div",{staticClass:"img"},[i("span",{staticClass:"up-span"},[t._v("+")]),i("img",{staticClass:"upimg",attrs:{src:t.team.image}}),i("input",{staticClass:"up-file",attrs:{type:"file",id:"file"},on:{change:function(e){t.upImg("file")}}})])]),i("div",{staticClass:"row"},[i("label",[t._v("名称")]),i("div",{staticClass:"fr"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.team.name,expression:"team.name"}],attrs:{placeholder:"活动名称",type:"text"},domProps:{value:t.team.name,value:t.team.name},on:{input:function(e){e.target.composing||(t.team.name=e.target.value)}}})])]),i("div",{staticClass:"row address",on:{click:t.showMap}},[i("label",[t._v("地址")]),i("div",{staticClass:"fr"},[i("input",{attrs:{placeholder:"地址",type:"text",readonly:"readonly"},domProps:{value:t.team.address}})])])]),i("div",{staticClass:"sort",on:{click:function(e){t.showDate=!0,t.timeInput="matchStartDate"}}},[i("label",[t._v("活动开始时间")]),i("span"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.team.matchStartDate,expression:"team.matchStartDate"}],attrs:{placeholder:"选择时间",type:"text",readonly:"readonly",id:"matchStartDate"},domProps:{value:t._f("time")(t.team.matchStartDate),value:t.team.matchStartDate},on:{input:function(e){e.target.composing||(t.team.matchStartDate=e.target.value)}}})]),i("div",{staticClass:"sort",on:{click:function(e){t.showDate=!0,t.timeInput="matchEndDate"}}},[i("label",[t._v("活动结束时间")]),i("span"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.team.matchEndDate,expression:"team.matchEndDate"}],attrs:{placeholder:"选择时间",type:"text",readonly:"readonly",id:"matchEndDate"},domProps:{value:t._f("time")(t.team.matchEndDate),value:t.team.matchEndDate},on:{input:function(e){e.target.composing||(t.team.matchEndDate=e.target.value)}}})]),i("div",{staticClass:"sort",on:{click:function(e){t.showDate=!0,t.timeInput="startDate"}}},[i("label",[t._v("报名开始时间")]),i("span"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.team.startDate,expression:"team.startDate"}],attrs:{placeholder:"选择时间",type:"text",readonly:"readonly",id:"startDate"},domProps:{value:t._f("time")(t.team.startDate),value:t.team.startDate},on:{input:function(e){e.target.composing||(t.team.startDate=e.target.value)}}})]),i("div",{staticClass:"sort",on:{click:function(e){t.showDate=!0,t.timeInput="endDate"}}},[i("label",[t._v("报名结束时间")]),i("span"),i("input",{directives:[{name:"model",rawName:"v-model",value:t.team.endDate,expression:"team.endDate"}],attrs:{placeholder:"选择时间",type:"text",readonly:"readonly",id:"endDate"},domProps:{value:t._f("time")(t.team.endDate),value:t.team.endDate},on:{input:function(e){e.target.composing||(t.team.endDate=e.target.value)}}})]),i("div",{staticClass:"form"},[i("div",{staticClass:"row"},[i("label",[t._v("活动人员上限")]),i("div",{staticClass:"fr"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.team.maxPerson,expression:"team.maxPerson"}],attrs:{placeholder:"请输入人员上限数量",type:"text",value:"team.maxPerson"},domProps:{value:t.team.maxPerson},on:{input:function(e){e.target.composing||(t.team.maxPerson=e.target.value)}}})])]),i("div",{staticClass:"row"},[t._m(0),i("div",{staticClass:"fr"},[i("div",{staticClass:"switch",class:1==t.team.joinway?"sure":"",on:{click:function(e){t.changeChoose("joinway")}}})])]),i("div",{staticClass:"row"},[i("label",[t._v("标签")]),i("div",{staticClass:"tag"},[t._l(t.team.tags,function(e,a){return i("div",{staticClass:"tag-box"},[i("span",[t._v(t._s(e.tag))]),i("div",{staticClass:"x",on:{click:function(e){t.delTag(a)}}},[t._v("x")])])}),i("div",{staticClass:"add-tag"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.newTag,expression:"newTag"}],attrs:{type:"text",placeholder:"标签"},domProps:{value:t.newTag,value:t.newTag},on:{input:function(e){e.target.composing||(t.newTag=e.target.value)}}}),i("div",{staticClass:"add",on:{click:t.addTag}},[t._v("贴上")])])],2)]),t._m(1),i("div",{staticClass:"row",staticStyle:{padding:"0 0.5rem 0.5rem"}},[t._m(2),i("table",{staticClass:"fee"},t._l(t.team.events,function(t,e){return i("tr",[i("td",{staticStyle:{width:"50%"}},[i("input",{attrs:{type:"text",readonly:"readonly"},domProps:{value:t.name}})]),i("td",{staticStyle:{width:"30%"}},[i("input",{attrs:{type:"text",readonly:"readonly"},domProps:{value:t.fee}})])])}))]),i("div",{staticClass:"row"},[i("label",[t._v("报名字段")]),i("div",{staticStyle:{"margin-top":"2rem","text-align":"left",overflow:"hidden"}},t._l(t.team.keys,function(e){return i("div",{staticClass:"key",class:e.isChoose?"choose":"",on:{click:function(t){e.isChoose=!e.isChoose}}},[t._v(t._s(e.str))])}))]),i("div",{staticClass:"row"},[i("label",[t._v("活动详情")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.team.detail,expression:"team.detail"}],attrs:{placeholder:"免责声明"},domProps:{value:t.team.detail,value:t.team.detail},on:{input:function(e){e.target.composing||(t.team.detail=e.target.value)}}})]),i("div",{staticClass:"row"},[i("label",[t._v("免责声明")]),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.team.declaration,expression:"team.declaration"}],attrs:{placeholder:"免责声明"},domProps:{value:t.team.declaration,value:t.team.declaration},on:{input:function(e){e.target.composing||(t.team.declaration=e.target.value)}}})]),i("div",{staticClass:"submit",on:{click:t.submit}},[t._v("确认修改")])])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isMapShow,expression:"isMapShow"}],staticClass:"map-ctn"},[i("div",{staticClass:"page-title"},[i("img",{staticClass:"back",attrs:{src:a(43)},on:{click:function(e){t.isMapShow=!1}}}),t._v("地图")]),i("div",{attrs:{id:"map"}}),t._m(3)])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",[t._v("是否公开报名"),a("div",[t._v("(公开报名后，非本团人员也可报名)")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row",staticStyle:{"border-bottom":"none"}},[a("label",[t._v("活动费用")]),a("div",{staticClass:"fr"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{overflow:"hidden"}},[a("div",{staticClass:"charge",staticStyle:{width:"50%","margin-right":"1rem"}},[a("span",[t._v("规格名称")])]),a("div",{staticClass:"charge",staticStyle:{width:"30%"}},[a("span",[t._v("费用/元")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search"},[a("input",{attrs:{type:"text",id:"searchkey",placeholder:"输入搜索地址！"}})])}]}}});