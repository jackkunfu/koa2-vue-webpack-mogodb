webpackJsonp([12],{362:function(t,i,e){function a(t){e(452)}var s=e(127)(e(454),e(455),a,"data-v-6cae86ff",null);t.exports=s.exports},379:function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAYAAADhXXHAAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+IEmuOgAAAgtJREFUWIXt1ztrFGEYhuErBxVFQUGbrewELRfUQkEQPIBiPGEjBpIgKmJhYauInY1FEJRoPKBBEBQlmEBAEH+CB/wFBmwEjahEYvElknyTmewuk5kgc8Oyy7MM3OzOPO/7UVFRUQFt9Xq9leu2YhAbcR1X8lNKp72Fa3ZgDJuxCpexKU+pNJqV3YlXWBPly/LRyaYZ2V0Yweoof4B3eQll0ajsbgwLf/tsHqEnV6MMGpHdgxeSovfRjT95S6WxkOw+PJcUHUSvAkXJlt0viK6M8gEliJIue1AQXRHlt3AaU4splcZ8sl14iuVRfhNnlSRKUvYonkiK9uO8EkWZK3scQ5KiN3BByaLQOf1+QujMjuj7O7iKtUVKRUzhK2GRSRNdSoyjp61er3/B+rJtGuBzK1tXabQLT3nhBd8k4+jtFKqqHQ8l79sBXCpYLObfAzbTBkOYxONZGfThOy5aAtXVUavVZj5/mH51mfsLb8c6jBarlmS2LHzEexw2V3gbNginhNKYrw2e4Rh+R/k5YT9oW2ypNNKq6yWO4FeUn8FtJQln9eywcP/+jPI+oSUKn3gLDYURQfhHlPcIe0Ohwo1MsFEckhTuxj0FCjc6bsdwQFL4JO7mapRBM7vBa+FcNhHlp7AlN6MMml1k3ggn3m9RPpmPTjatbF1vsVeYdhO4hk95SlVUVFT8R/wFRURXGecH2+wAAAAASUVORK5CYII="},380:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={data:function(){return{areaList:[]}},methods:{showNearList:function(t){this.areaList=t.regeocode.pois},getAddressInfo:function(t,i){var e=this;$.ajax({type:"GET",url:"https://restapi.amap.com/v3/geocode/regeo",dataType:"JSON",data:{output:"JSON",location:t+","+i,key:"5b384bd6b1c25c86a18cdef18c82c679",radius:10,extensions:"base"},success:function(a){e.chooseMapCallback&&e.chooseMapCallback(a,t,i)}})},showMap:function(){var t,i=this,e=!0;this.cmFun.getLocation(function(a){i.lng=a.coords.longitude,i.lat=a.coords.latitude,t=[a.coords.longitude,a.coords.latitude],e=!1}),this.isMapShow=!0;var a=this;AMapUI.loadUI(["misc/PositionPicker"],function(t){function i(t){t.poi&&t.poi.location&&(e.setZoom(15),e.setCenter(t.poi.location),marker.setPosition(new AMap.LngLat(t.poi.location.lng,t.poi.location.lat)))}var e=new AMap.Map("map",{zoom:16,scrollWheel:!1}),s=new t({mode:"dragMap",map:e});s.start(),e.panBy(0,1),s.on("success",function(t){console.log(t),a.showNearList(t)});var n=new AMap.Autocomplete({input:"searchkey"});AMap.event.addListener(n,"select",i);e.on("click",function(t){var i=t.lnglat.getLng(),e=t.lnglat.getLat();$.ajax({type:"GET",url:"https://restapi.amap.com/v3/geocode/regeo",dataType:"JSON",data:{output:"JSON",location:i+","+e,key:"5b384bd6b1c25c86a18cdef18c82c679",radius:10,extensions:"base"},success:function(t){a.chooseMapCallback&&a.chooseMapCallback(t,i,e)}})})})}}}},452:function(t,i,e){var a=e(453);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e(350)("5ec96dac",a,!0)},453:function(t,i,e){i=t.exports=e(349)(!1),i.push([t.i,".form .row .img .upimg[data-v-6cae86ff]{left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);background:#fff;height:100%}.edit-input[data-v-6cae86ff]{font-size:1rem;width:100%;background:#fff;padding-left:.3rem;margin-top:.5rem;height:2.5rem;border:none}.edit-input+span[data-v-6cae86ff]{float:right;margin-right:.5rem}.map-ctn #map[data-v-6cae86ff],.map-ctn .close[data-v-6cae86ff],.map-ctn .search[data-v-6cae86ff]{position:fixed}.map-ctn #map[data-v-6cae86ff]{width:100%;height:100%;top:0;left:0}.map-ctn .search[data-v-6cae86ff]{width:20rem;height:2.5rem;top:3rem;left:50%;margin-left:-10rem}.map-ctn .search input[data-v-6cae86ff]{width:100%;height:100%;background:#fff;font-size:1rem}.map-ctn .close[data-v-6cae86ff]{width:5rem;height:5rem;font-size:4rem;text-align:center;background:#fff;border:1px solid #c1c1c1;top:10rem;left:50%;margin-left:20rem}",""])},454:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a=e(380),s=function(t){return t&&t.__esModule?t:{default:t}}(a),n=function(t){return 1==(t+"").length?"0"+t:t};i.default={name:"myInfo",mixins:[s.default],filters:{birth:function(t){if(!t)return"";var i=new Date(t);return n(i.getFullYear())+"-"+n(i.getMonth())+"-"+n(i.getDate())},address:function(t){return t?t.length>20?t.substring(0,20)+"...":t:""}},data:function(){return{info:{birth:""},id:localStorage.aliSportUserId,editStatus:!1,editKey:"",editStr:"",editNick:"",editName:"",editEmail:"",editCardno:"",editContact:"",editContactNo:"",showBtm:!1,btmKey:"",isMapShow:!1,canChangeRealName:!1}},mounted:function(){var t=this,i=this;document.addEventListener("optionMenu",function(t){"/myInfo"==i.$route.path&&i.save()},!1),aliPayNative.setTitle("个人设置"),aliPayNative.setOptBtn("保存"),this.cmFun.ajax("get","/user/view/"+this.id,{},function(i){t.info=i,0==t.info.sex?t.info.sex="女":1==t.info.sex&&(t.info.sex="男"),i.name&&""!=i.name.replace(/\s+/g,"")||(t.canChangeRealName=!0)}),this.$nextTick(function(){var i=new Date,e=(i.getFullYear(),i.getMonth(),i.getDate(),t);(new datePicker).init({trigger:"#birth",type:"date",minDate:"1900-1-1",maxDate:"2099-1-1",onSubmit:function(){e.info.birth=this.value},onClose:function(){}})})},methods:{save:function(){var t=this;if(!this.info.nick||""==this.info.nick.trim())return void alert("昵称没填~");if(!this.info.name||""==this.info.name.trim())return void alert("真实姓名没填~");if(!this.info.sex||""==this.info.sex)return void alert("性别没选~");if(!this.info.birth||""==this.info.birth)return void alert("生日没选~");if(!this.info.email||""==this.info.email.trim())return void alert("邮箱没填~");if(!this.info.city||""==this.info.city)return void alert("城市地址没选~");if(!this.info.height||""==this.info.height)return void alert("身高没选~");if(!this.info.weight||""==this.info.weight)return void alert("体重没选~");if(!this.info.blood||""==this.info.blood)return void alert("血型没选~");if(!this.info.cardType||""==this.info.cardType)return void alert("证件类型没选~");if(!this.info.cardno||""==this.info.cardno.trim())return void alert("证件号没填~");if(!this.info.colthSize||""==this.info.colthSize)return void alert("服装尺寸没选~");if(!this.info.contact||""==this.info.contact.trim())return void alert("紧急联系人没填~");if(!this.info.contactNumber||""==this.info.contactNumber.trim())return void alert("紧急联系人电话没填~");var i=$.extend(!0,{},this.info);"男"==i.sex?i.sex=1:"女"==i.sex&&(i.sex=0),(i.birth+"").indexOf("-")<0||(i.birth=new Date(i.birth.replace(/\-/g,"/")).getTime()),this.cmFun.ajax("post","/user/save",i,function(i){if(1!=i.code)return void alert(i.msg);alert("修改成功"),t.info={},t.$router.push({path:"/my",query:{id:t.id}})})},updateMsg:function(t){var i=this.btmKey,e={};e[i]=t,this.info[i]=t,e.id=this.id},edit:function(t){("name"!=t||this.canChangeRealName)&&(this.editKey=t,this.editStatus=!0,"nick"==t?this.editStr="昵称":"email"==t?this.editStr="邮箱":"contact"==t?this.editStr="紧急联系人姓名":"contactNumber"==t?this.editStr="紧急联系人联系方式":"cardno"==t&&(this.editStr="证件号"))},editSure:function(){var t={};if("name"==this.editKey){var i=this.editName.trim();if(""==i)return void alert("真实姓名不能为空");t[this.editKey]=i,this.info[this.editKey]=i}else if("nick"==this.editKey){var i=this.editNick.trim();if(""==i||i.length>13)return void alert("昵称长度为13个以内");t[this.editKey]=i,this.info[this.editKey]=i}else if("email"==this.editKey){if(!/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/.test(this.editEmail))return void alert("邮箱格式不对~");t[this.editKey]=this.editEmail,this.info[this.editKey]=this.editEmail}else if("contact"==this.editKey){var i=this.editContact.trim();if(""==i)return void alert("不能为空~");t[this.editKey]=this.editContact,this.info[this.editKey]=this.editContact}else if("contactNumber"==this.editKey){if(!/^1[3|4|5|7|8][0-9]\d{8}$/.test(this.editContactNo))return void alert("号码有误~");t[this.editKey]=this.editContactNo,this.info[this.editKey]=this.editContactNo}else if("cardno"==this.editKey){var e=/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/,a=/^1[45][0-9]{7}|([P|p|S|s]\d{7})|([S|s|G|g]\d{8})|([Gg|Tt|Ss|Ll|Qq|Dd|Aa|Ff]\d{8})|([H|h|M|m]\d{8，10})$/,s=/^[a-zA-Z0-9]{5,21}$/;if(!(e.test(this.editCardno)||a.test(this.editCardno)||s.test(this.editCardno)))return void alert("证件号有误~");t[this.editKey]=this.editCardno,this.info[this.editKey]=this.editCardno}this.editKey="",this.editNick=this.editName=this.editEmail=this.editCardno=this.editContact=this.editContactNo=""},upImg:function(t,i){var e=this;this.cmFun.upFile(t,"dir",function(t){if(1!=t.code)return void alert(t.msg);var a={};a.id=e.id,a[i]=t.data,e.info[i]=t.data})},goBack:function(){window.history.go(-1)},chooseMapCallback:function(t,i,e){var a=this,s=t.regeocode.addressComponent,n={longitude:i,latitude:e,province:s.province,city:"string"==typeof s.city?s.city:"",area:s.district,address:t.regeocode.formatted_address};$(".amap-sug-result").remove(),a.info.city=n.city,a.info.address=n.address,a.isMapShow=!1}}}},455:function(t,i,e){t.exports={render:function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"myInfo"},[a("div",{directives:[{name:"show",rawName:"v-show",value:""==t.editKey,expression:"editKey==''"}]},[a("div",{staticClass:"form"},[a("div",{staticClass:"row photo"},[a("label",[t._v("头像")]),a("div",{staticClass:"fr"},[a("img",{attrs:{src:t.info.image}}),a("input",{attrs:{type:"file",accept:"image/*",id:"file"},on:{change:function(i){t.upImg("file","image")}}})])])]),a("div",{staticClass:"sort",on:{click:function(i){t.edit("nick")}}},[t._v("昵称"),a("span",[t._v(t._s(t.info.nick))])]),a("div",{staticClass:"sort",on:{click:function(i){t.edit("name")}}},[t._v("真实姓名"),a("span",{class:t.canChangeRealName?"":"none"},[t._v(t._s(t.info.name))])]),a("div",{staticClass:"sort",on:{click:function(i){t.btmKey="sex",t.showBtm=!0}}},[t._v("性别"),a("span",[t._v(t._s(t.info.sex))])]),a("div",{staticClass:"sort",attrs:{id:"birth"}},[t._v("生日"),a("span",[t._v(t._s(t._f("birth")(t.info.birth)))])]),a("div",{staticClass:"sort"},[t._v("手机号"),a("span",{staticClass:"none"},[t._v(t._s(t.info.mobile))])]),a("div",{staticClass:"sort",on:{click:function(i){t.edit("email")}}},[t._v("邮箱"),a("span",[t._v(t._s(t.info.email))])]),a("div",{staticClass:"sort",on:{click:t.showMap}},[t._v("城市"),a("span",[t._v(t._s(t.info.city))])]),a("div",{staticClass:"sort"},[t._v("详细地址"),a("span",{staticClass:"none"},[t._v(t._s(t._f("address")(t.info.address)))])]),a("div",{staticClass:"sort",on:{click:function(i){t.btmKey="height",t.showBtm=!0}}},[t._v("身高"),a("span",[t._v(t._s(t.info.height))])]),a("div",{staticClass:"sort",on:{click:function(i){t.btmKey="weight",t.showBtm=!0}}},[t._v("体重"),a("span",[t._v(t._s(t.info.weight))])]),a("div",{staticClass:"sort",on:{click:function(i){t.btmKey="blood",t.showBtm=!0}}},[t._v("血型"),a("span",[t._v(t._s(t.info.blood))])]),a("div",{staticClass:"sort",on:{click:function(i){t.btmKey="cardType",t.showBtm=!0}}},[t._v("证件类型"),a("span",[t._v(t._s(t.info.cardType))])]),a("div",{staticClass:"sort",on:{click:function(i){t.edit("cardno")}}},[t._v("证件号"),a("span",[t._v(t._s(t.info.cardno))])]),a("div",{staticClass:"sort",on:{click:function(i){t.btmKey="colthSize",t.showBtm=!0}}},[t._v("服装尺寸"),a("span",[t._v(t._s(t.info.colthSize))])]),a("div",{staticClass:"sort",on:{click:function(i){t.edit("contact")}}},[t._v("紧急联系人"),a("span",[t._v(t._s(t.info.contact))])]),a("div",{staticClass:"sort",on:{click:function(i){t.edit("contactNumber")}}},[t._v("紧急联系人号码"),a("span",[t._v(t._s(t.info.contactNumber))])]),a("div",{staticClass:"form"},[a("div",{staticClass:"row"},[a("label",[t._v("完赛证明")]),a("div",{staticClass:"img"},[a("img",{staticClass:"upimg",attrs:{src:t.info.healthCert}}),a("span",{staticClass:"up-span"},[t._v("+")]),a("input",{staticClass:"up-file",attrs:{type:"file",id:"file1"},on:{change:function(i){t.upImg("file1","healthCert")}}})])])]),a("div",{staticClass:"form"},[a("div",{staticClass:"row"},[a("label",[t._v("健康证明")]),a("div",{staticClass:"img"},[a("img",{staticClass:"upimg",attrs:{src:t.info.raceCert}}),a("span",{staticClass:"up-span"},[t._v("+")]),a("input",{staticClass:"up-file",attrs:{type:"file",id:"file2"},on:{change:function(i){t.upImg("file2","raceCert")}}})])])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:""!=t.editKey,expression:" editKey !='' "}]},[a("div",{staticClass:"page-title"},[a("img",{staticClass:"back",attrs:{src:e(379)},on:{click:function(i){t.editKey="",t.editNick=t.editName=t.editEmail=t.editCardno=t.editContact=t.editContactNo=""}}}),a("span",[t._v(t._s(t.editStr))]),a("div",{staticClass:"features",on:{click:t.editSure}},[t._v("确定")])]),"nick"==t.editKey?a("div",{staticStyle:{"padding-top":"2rem"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editNick,expression:"editNick"}],staticClass:"edit-input",attrs:{type:"text",placeholder:"请输入昵称",value:"editNick"},domProps:{value:t.editNick},on:{input:function(i){i.target.composing||(t.editNick=i.target.value)}}}),a("span",[t._v(t._s(13-t.editNick.replace(/\s+/g,"").length))])]):t._e(),"name"==t.editKey?a("div",{staticStyle:{"padding-top":"2rem"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editName,expression:"editName"}],staticClass:"edit-input",attrs:{type:"text",placeholder:"请输入真实姓名",value:"editName"},domProps:{value:t.editName},on:{input:function(i){i.target.composing||(t.editName=i.target.value)}}})]):t._e(),"email"==t.editKey?a("div",{staticStyle:{"padding-top":"2rem"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editEmail,expression:"editEmail"}],staticClass:"edit-input",attrs:{type:"text",placeholder:"请输入邮箱",value:"editEmail"},domProps:{value:t.editEmail},on:{input:function(i){i.target.composing||(t.editEmail=i.target.value)}}})]):t._e(),"cardno"==t.editKey?a("div",{staticStyle:{"padding-top":"2rem"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editCardno,expression:"editCardno"}],staticClass:"edit-input",attrs:{type:"text",placeholder:"请输入证件号",value:"editCardno.slice(0,18)"},domProps:{value:t.editCardno},on:{input:function(i){i.target.composing||(t.editCardno=i.target.value)}}})]):t._e(),"contact"==t.editKey?a("div",{staticStyle:{"padding-top":"2rem"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editContact,expression:"editContact"}],staticClass:"edit-input",attrs:{type:"text",placeholder:"请输入紧急联系人姓名",value:"editContact"},domProps:{value:t.editContact},on:{input:function(i){i.target.composing||(t.editContact=i.target.value)}}})]):t._e(),"contactNumber"==t.editKey?a("div",{staticStyle:{"padding-top":"2rem"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.editContactNo,expression:"editContactNo"}],staticClass:"edit-input",attrs:{type:"text",placeholder:"请输入紧急联系人联系方式",value:"editContactNo"},domProps:{value:t.editContactNo},on:{input:function(i){i.target.composing||(t.editContactNo=i.target.value)}}})]):t._e()]),a("div",{staticClass:"btm-hide",class:t.showBtm?"show":"hide",on:{click:function(i){t.showBtm=!1}}},["sex"==t.btmKey?a("div",{staticClass:"btm"},[a("div",{staticClass:"title"},[t._v("选择性别")]),a("ul",[a("li",{on:{click:function(i){t.updateMsg("男")}}},[t._v("男")]),a("li",{on:{click:function(i){t.updateMsg("女")}}},[t._v("女")])])]):t._e(),"height"==t.btmKey?a("div",{staticClass:"btm"},[a("div",{staticClass:"title"},[t._v("选择身高")]),a("ul",t._l([140,145,150,155,160,165,170,175,180,185,190,195],function(i){return a("li",{on:{click:function(e){t.updateMsg(i)}}},[t._v(t._s(i))])}))]):t._e(),"weight"==t.btmKey?a("div",{staticClass:"btm"},[a("div",{staticClass:"title"},[t._v("选择体重")]),a("ul",t._l([50,55,60,65,70,75,80,85,90,95,100,105,110,115,120],function(i){return a("li",{on:{click:function(e){t.updateMsg(i)}}},[t._v(t._s(i))])}))]):t._e(),"blood"==t.btmKey?a("div",{staticClass:"btm"},[a("div",{staticClass:"title"},[t._v("血型")]),a("ul",t._l(["O","AB","A","B"],function(i){return a("li",{on:{click:function(e){t.updateMsg(i)}}},[t._v(t._s(i))])}))]):t._e(),"cardType"==t.btmKey?a("div",{staticClass:"btm"},[a("div",{staticClass:"title"},[t._v("证件类型")]),a("ul",t._l(["身份证","港澳台通行证","台胞证","护照"],function(i){return a("li",{on:{click:function(e){t.updateMsg(i)}}},[t._v(t._s(i))])}))]):t._e(),"colthSize"==t.btmKey?a("div",{staticClass:"btm"},[a("div",{staticClass:"title"},[t._v("服装尺码")]),a("ul",t._l(["S","M","L","XL","XXL"],function(i){return a("li",{on:{click:function(e){t.updateMsg(i)}}},[t._v(t._s(i))])}))]):t._e()]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.isMapShow,expression:"isMapShow"}],staticClass:"map-ctn"},[a("div",{staticClass:"page-title"},[a("img",{staticClass:"back",attrs:{src:e(379)},on:{click:function(i){t.isMapShow=!1}}}),t._v("地图")]),a("div",{staticClass:"map"},[a("div",{attrs:{id:"map"}}),a("div",{staticClass:"area-list"},t._l(t.areaList,function(i,e){return a("div",{staticClass:"item",on:{click:function(e){t.getAddressInfo(i.location.lng,i.location.lat)}}},[a("div",{staticClass:"name"},[t._v(t._s(i.name))]),a("div",{staticClass:"address"},[t._v(t._s(i.address))])])}))])])])},staticRenderFns:[]}}});